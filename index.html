<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Practice Hub</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: #f5f7fa; color: #1a202c; line-height: 1.6; }
        .header { background: #2c5aa0; color: white; padding: 24px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .header-content { max-width: 1000px; margin: 0 auto; padding: 0 24px; display: flex; justify-content: space-between; align-items: center; }
        .logo { display: flex; align-items: center; gap: 12px; }
        .logo-icon { font-size: 32px; }
        .logo-text h1 { font-size: 22px; font-weight: 700; letter-spacing: -0.5px; }
        .student-info { text-align: right; font-size: 14px; }
        .container { max-width: 800px; margin: 40px auto; padding: 0 24px; }
        .assessment-card { background: white; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding: 32px; margin-bottom: 24px; }
        .assessment-header { border-bottom: 2px solid #e2e8f0; padding-bottom: 16px; margin-bottom: 24px; }
        .assessment-header h2 { font-size: 24px; color: #2c5aa0; margin-bottom: 8px; }
        .assessment-meta { font-size: 14px; color: #718096; }
        .question { margin-bottom: 32px; padding: 20px; background: #f8fafc; border-left: 4px solid #2c5aa0; border-radius: 4px; }
        .question-number { font-weight: 600; color: #2c5aa0; font-size: 14px; margin-bottom: 8px; }
        .question-text { font-size: 16px; margin-bottom: 16px; color: #2d3748; }
        .math-expression { font-family: 'Courier New', monospace; background: white; padding: 12px 16px; border-radius: 4px; border: 1px solid #cbd5e0; display: inline-block; margin: 8px 0; font-size: 15px; }
        input[type="text"] { width: 100%; padding: 12px 16px; border: 2px solid #cbd5e0; border-radius: 4px; font-size: 15px; font-family: 'Inter', sans-serif; transition: border-color 0.2s; }
        input[type="text"]:focus { outline: none; border-color: #2c5aa0; }
        .submit-btn { background: #2c5aa0; color: white; padding: 14px 32px; border: none; border-radius: 4px; font-size: 16px; font-weight: 600; cursor: pointer; font-family: 'Inter', sans-serif; transition: background 0.2s; width: 100%; }
        .submit-btn:hover { background: #234a87; }
        .footer { text-align: center; padding: 24px; color: #718096; font-size: 13px; }
        .instructions { background: #e6f2ff; border: 1px solid #bee3f8; border-radius: 4px; padding: 16px; margin-bottom: 24px; font-size: 14px; color: #2c5aa0; }
        .verification-modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 1000; align-items: center; justify-content: center; }
        .verification-modal.active { display: flex; }
        .modal-content { background: white; padding: 32px; border-radius: 4px; max-width: 500px; width: 90%; box-shadow: 0 4px 6px rgba(0,0,0,0.2); }
        .modal-content h3 { color: #2c5aa0; margin-bottom: 16px; font-size: 20px; }
        .modal-content p { margin-bottom: 20px; color: #4a5568; }
        .gamehub { display: none; }
        .gamehub.active { display: block; }
        body.game-mode { background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0a0a0a 100%); color: #fff; }
        .games-container { max-width: 1200px; margin: 0 auto; padding: 40px 48px 80px; min-height: 100vh; }
        .games-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; }
        .game-card { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 4px; padding: 32px 20px; text-align: center; cursor: pointer; transition: all 0.2s; position: relative; overflow: hidden; }
        .game-card:hover { transform: translateY(-4px); border-color: rgba(255, 255, 255, 0.3); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); }
        .game-icon { font-size: 48px; margin-bottom: 16px; }
        .game-title { font-size: 15px; font-weight: 600; margin-bottom: 6px; color: white; }
        .game-desc { font-size: 12px; color: rgba(255, 255, 255, 0.5); }
        .url-modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.7); z-index: 2000; align-items: center; justify-content: center; }
        .url-modal.active { display: flex; }
        .url-modal-content { background: #1a1a1a; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; }
        .url-modal-header { padding: 24px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); display: flex; justify-content: space-between; align-items: center; }
        .url-modal-header h3 { color: white; font-size: 20px; font-weight: 600; }
        .close-btn { background: none; border: none; color: rgba(255, 255, 255, 0.6); font-size: 24px; cursor: pointer; transition: color 0.2s; }
        .close-btn:hover { color: white; }
        .url-modal-body { padding: 24px; }
        .url-form-group { margin-bottom: 16px; }
        .url-form-group label { display: block; color: rgba(255, 255, 255, 0.8); font-size: 14px; margin-bottom: 8px; font-weight: 500; }
        .url-form-group input { width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 4px; color: white; font-size: 14px; font-family: 'Inter', sans-serif; }
        .url-submit-btn { background: white; color: black; padding: 12px 24px; border: none; border-radius: 4px; font-size: 14px; font-weight: 600; cursor: pointer; width: 100%; transition: transform 0.2s; }
        .url-submit-btn:hover { transform: translateY(-2px); }
        .url-item { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 4px; padding: 16px; margin-bottom: 12px; }
        .url-item-title { color: white; font-size: 15px; font-weight: 600; margin-bottom: 4px; }
        .url-item-link { color: rgba(255, 255, 255, 0.6); font-size: 13px; text-decoration: none; word-break: break-all; display: block; margin-bottom: 8px; }
    </style>
</head>
<body>
    <div id="mathPage">
        <div class="header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">üìê</div>
                    <div class="logo-text"><h1>Math Practice Hub</h1></div>
                </div>
                <div class="student-info">
                    <div><strong>Session:</strong> MP-2025-10293</div>
                    <div><strong>Date:</strong> <span id="session-date"></span></div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="assessment-card">
                <div class="assessment-header">
                    <h2>Daily Math Question of the Day</h2>
                    <div class="assessment-meta"><strong>Grade Level:</strong> 8th Grade | <strong>Topic:</strong> Algebra & Geometry</div>
                </div>
                <div class="instructions"><strong>Instructions:</strong> Solve today's math challenge and submit your answer!</div>
                <form id="assessmentForm"></form>
            </div>
        </div>
        <div class="footer">¬© 2025 Math Practice Hub | Supporting Student Success in Mathematics</div>
    </div>
    <div id="verificationModal" class="verification-modal">
        <div class="modal-content">
            <h3>üîê Verification Required</h3>
            <p>To proceed, please enter the verification code:</p>
            <input type="text" id="verificationInput" placeholder="Enter verification code">
            <button onclick="verifyCode()" class="submit-btn" style="margin-top: 16px;">Verify</button>
        </div>
    </div>
    <div id="gameHub" class="gamehub">
        <div class="games-container"><div class="games-grid" id="gamesGrid"></div></div>
    </div>
    <div id="urlModal" class="url-modal">
        <div class="url-modal-content">
            <div class="url-modal-header">
                <h3>üîó Share Unblocked Sites</h3>
                <button class="close-btn" onclick="closeUrlModal()">√ó</button>
            </div>
            <div class="url-modal-body">
                <div id="messageContainer"></div>
                <form id="urlForm">
                    <div class="url-form-group">
                        <label>Site Name</label>
                        <input type="text" id="siteTitle" placeholder="e.g., Cool Math Games" required>
                    </div>
                    <div class="url-form-group">
                        <label>URL (without https://)</label>
                        <input type="text" id="siteUrl" placeholder="example.com" required>
                    </div>
                    <div class="url-form-group">
                        <label>Description (Optional)</label>
                        <input type="text" id="siteDescription" placeholder="Brief description">
                    </div>
                    <button type="submit" class="url-submit-btn" id="urlSubmitBtn">Add Site</button>
                </form>
                <div style="margin-top:24px"><h4 style="color:white;margin-bottom:16px">Community Shared Sites</h4><div id="urlsList"><div style="text-align:center;padding:20px;color:rgba(255,255,255,0.6)">Loading...</div></div></div>
            </div>
        </div>
    </div>
    <script>
        document.getElementById("session-date").textContent=new Date().toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});
        const SUPABASE_URL='https://ewfecnnxuqtzhlsuljqv.supabase.co';
        const SUPABASE_ANON_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV3ZmVjbm54dXF0emhsc3VsanF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE3OTAyMTksImV4cCI6MjA3NzM2NjIxOX0.QgDEhfh1kpZCxd7s7e4LnUlBk_ERv30DCF78-pSDlDM';
        let supabase=null;
        try{supabase=window.supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY)}catch(e){console.error('Supabase init failed:',e)}
        const questionBank=[{text:'Solve for x:',expr:'3x + 7 = 22',placeholder:'Enter your answer'},{text:'What is the area of a circle with radius 5 cm? (Use œÄ ‚âà 3.14)',expr:null,placeholder:'Enter your answer in cm¬≤'},{text:'Simplify the expression:',expr:'2(4x - 3) + 5x',placeholder:'Enter simplified form'}];
        
        // EASY GAME CONFIGURATION - Just add games here!
        const games=[
            {icon:'Gr',title:'Granny',desc:'Horror',file:'games/granny.html'},
            {icon:'üèà',title:'Retro Bowl',desc:'Sports',file:'games/retrobowl.html'},
            {icon:'‚¨ÜÔ∏è',title:'Only Up',desc:'Parkour',file:'games/onlyup.html'},
            {icon:'‚õèÔ∏è',title:'Minecraft',desc:'Sandbox',file:'games/minecraft.html'},
            {icon:'üîó',title:'Share Sites',desc:'Add URLs',action:'openUrlModal'}
        ];
        
        function getDayOfYear(){const now=new Date();const start=new Date(now.getFullYear(),0,0);return Math.floor((now-start)/(1000*60*60*24))}
        const dayIndex=getDayOfYear()%questionBank.length;
        const todaysQuestion=questionBank[dayIndex];
        const isUnlocked=localStorage.getItem('gameHubUnlocked')==='true';
        if(isUnlocked){showGameHub()}else{const form=document.getElementById('assessmentForm');const questionDiv=document.createElement('div');questionDiv.className='question';questionDiv.innerHTML=`<div class="question-number">Question of the Day</div><div class="question-text">${todaysQuestion.text}</div>${todaysQuestion.expr?`<div class="math-expression">${todaysQuestion.expr}</div>`:''}<input type="text" id="q1" placeholder="${todaysQuestion.placeholder}" required>`;form.appendChild(questionDiv);const submitBtn=document.createElement('button');submitBtn.type='submit';submitBtn.className='submit-btn';submitBtn.textContent='Submit Answer';form.appendChild(submitBtn)}
        function showGameHub(){document.getElementById('mathPage').style.display='none';document.getElementById('verificationModal').classList.remove('active');document.getElementById('gameHub').classList.add('active');document.body.classList.add('game-mode');document.title='Google Classroom';const link=document.querySelector("link[rel*='icon']")||document.createElement('link');link.type='image/x-icon';link.rel='shortcut icon';link.href='https://ssl.gstatic.com/classroom/favicon.png';document.getElementsByTagName('head')[0].appendChild(link);const grid=document.getElementById('gamesGrid');grid.innerHTML='';games.forEach(game=>{const card=document.createElement('div');card.className='game-card';card.innerHTML=`<div class="game-icon">${game.icon}</div><div class="game-title">${game.title}</div><div class="game-desc">${game.desc}</div>`;card.onclick=()=>{if(game.action==='openUrlModal'){openUrlModal()}else if(game.file){window.open(game.file,'_blank')}};grid.appendChild(card)})}
        function openUrlModal(){document.getElementById('urlModal').classList.add('active');loadUrls()}
        function closeUrlModal(){document.getElementById('urlModal').classList.remove('active')}
        async function loadUrls(){const urlsList=document.getElementById('urlsList');urlsList.innerHTML='<div>Loading...</div>';if(!supabase){urlsList.innerHTML='<div style="color:#ff3b30">Database unavailable</div>';return}try{const{data,error}=await supabase.from('shared_urls').select('*').order('created_at',{ascending:false}).limit(50);if(error)throw error;if(!data||data.length===0){urlsList.innerHTML='<p style="color:rgba(255,255,255,0.5);text-align:center;padding:20px">No sites shared yet</p>';return}urlsList.innerHTML='';data.forEach(url=>{const item=document.createElement('div');item.className='url-item';const date=new Date(url.created_at).toLocaleDateString();item.innerHTML=`<div class="url-item-title">${url.title}</div><a href="${url.url}" target="_blank" class="url-item-link">${url.url}</a>${url.description?`<div style="color:rgba(255,255,255,0.6);font-size:13px">${url.description}</div>`:''}<div style="font-size:12px;color:rgba(255,255,255,0.4)">${date}</div>`;urlsList.appendChild(item)})}catch(error){urlsList.innerHTML='<div style="color:#ff3b30">Failed to load sites</div>'}}
        document.getElementById('urlForm').addEventListener('submit',async function(e){e.preventDefault();if(!supabase)return alert('Database unavailable');const submitBtn=document.getElementById('urlSubmitBtn');const title=document.getElementById('siteTitle').value.trim();let url=document.getElementById('siteUrl').value.trim().toLowerCase();const description=document.getElementById('siteDescription').value.trim();if(!title||!url)return alert('Please fill in all required fields');url=url.replace(/^(https?:\/\/)?(www\.)?/,'');const fullUrl='https://'+url;try{submitBtn.disabled=true;submitBtn.textContent='Adding...';const{error}=await supabase.from('shared_urls').insert([{title:title,url:fullUrl,description:description||null}]);if(error)throw error;alert('Site added successfully!');document.getElementById('urlForm').reset();loadUrls()}catch(error){alert('Failed to add site')}finally{submitBtn.disabled=false;submitBtn.textContent='Add Site'}});
        document.addEventListener('keydown',function(e){if(e.ctrlKey&&e.shiftKey&&e.key.toLowerCase()==='x'){localStorage.removeItem('gameHubUnlocked');location.reload()}});
        document.getElementById('assessmentForm').addEventListener('submit',function(e){e.preventDefault();const answer=document.getElementById('q1').value.toLowerCase();if(answer.includes('curiosity')){document.getElementById('verificationModal').classList.add('active')}else{alert('Answer submitted. Great work on today\'s challenge!')}});
        function verifyCode(){const code=document.getElementById('verificationInput').value;if(code==='ifykyk'){localStorage.setItem('gameHubUnlocked','true');showGameHub()}else{alert('Incorrect verification code');document.getElementById('verificationInput').value=''}}
        document.getElementById('verificationInput').addEventListener('keypress',function(e){if(e.key==='Enter')verifyCode()});
        document.getElementById('urlModal').addEventListener('click',function(e){if(e.target===this)closeUrlModal()});
    </script>
</body>
</html>
